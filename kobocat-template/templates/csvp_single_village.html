{% extends 'base_test.html' %}
{% load i18n %}
{% block additional-headers %}
<head>
	<title>
		{% block title %} CSVP {% endblock %}
	</title>
</head>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<link href="{{STATIC_URL}}css/csvp.css" rel="stylesheet" type="text/css"/>
{% endblock %}
{% block content %}

<!--<div class="row upper-div">
	<div class="col-md-6">
		<!-- <span class="page-title-csvp">Village: <strong>Bahadurpur</strong> At a Glance</span> -->
		<!--<select id="lang-switch" onchange="changeLanguage(this);setCookie('lang',this.value)" class="form-control"><option value="b">Bangla</option><option value="e">English</option></select>
	</div>-->
	<!--<div class="col-md-6">
		<form class="form-inline" action="#">
			<div class="input-group input-large pull-right">
				<input type="text" class="form-control" placeholder="Village Name">
				<span class="input-group-btn">
					<button class="btn red" type="button"><span>Search</span></button>
				</span>
			</div>
		</form>
	</div>
</div>-->

<!-- <div class="accordion" id="accordion2">
	<div class="accordion-group">
		<div class="accordion-heading">
			<a class="accordion-toggle" data-toggle="collapse" href="#collapseOne">
				Social Map & Legends <i class="fa fa-caret-right"></i>
			</a>
		</div>
		<div id="collapseOne" class="accordion-body collapse in">
			<div class="accordion-inner">
				<div class="row">
	<div class="col-md-9">
		<div style="height:400px;width: 100%;" id="social_map_container"></div>
	</div>
	<div class="col-md-3 legend-box">
		
	</div>
</div>
			</div>
		</div>
	</div>
</div> -->
<div class="top-buffer"></div>
<div class="row">
	<div class="col-md-10">
		<ul class="list-inline village-label">
			<li><strong><span class="lang_en">District</span><span class="lang_bd hide_lang">জেলা</span></strong> : <span id="district_en" class="lang_en"></span><span id="district_bn" class="lang_bd hide_lang"></span></li>
			<li><strong><span class="lang_en">Upazilla</span><span class="lang_bd hide_lang">উপজেলা</span></strong> : <span id="upazilla_en" class="lang_en"></span><span id="upazilla_bn" class="lang_bd hide_lang"></span></li>
			<li><strong><span class="lang_en">Union</span><span class="lang_bd hide_lang">ইউনিয়ন</span></strong> : <span id="union_en" class="lang_en"></span><span id="union_bn" class="lang_bd hide_lang"></span></li>
			<li><strong><span class="lang_en">Village</span><span class="lang_bd hide_lang">গ্রাম</span></strong> : <span id="village_en" class="lang_en"></span><span id="village_bn" class="lang_bd hide_lang"></span></li>
			<li><strong><span class="lang_en">NGO</span><span class="lang_bd hide_lang">এনজিও</span></strong> : <span id="ngo_en" class="lang_en"></span><span id="ngo_bn" class="lang_bd hide_lang"></span></li>
		</ul>

	</div>
	<div class="col-md-2">
		<select id="lang-switch" onchange="changeLanguage(this);setCookie('lang',this.value)" class="form-control pull-right"><option value="b">Bangla</option><option value="e">English</option></select>
	</div>
</div>



<div style="margin-top: 5px;"></div>
<div class="row">
	<div class="col-md-12">
		<ul class="nav nav-tabs">
			<li class="active"><a href="#tab_1_0" data-toggle="tab">Social Map</a></li>
			<li class=""><a href="#tab_1_1" data-toggle="tab">Summary</a></li>
			<li class=""><a href="#tab_1_2" data-toggle="tab">Seasonal Calendar</a></li>
			<li class=""><a href="#tab_1_3" data-toggle="tab">Crop Calendar</a></li>
			<li class=""><a href="#tab_1_4" data-toggle="tab">Impact of Climate Change</a></li>
			<li class=""><a href="#tab_1_5" data-toggle="tab">Livelihood Analysis</a></li>
			<li class=""><a href="#tab_1_6" data-toggle="tab">Problem Matrix</a></li>
			<li class=""><a href="#tab_1_7" data-toggle="tab">Solution to Problems</a></li>
			<li class=""><a href="#tab_1_8" data-toggle="tab">Action Plan</a></li>
		</ul>
		<div class="tab-content">
			<div class="tab-pane fade active in" id="tab_1_0">
				<!--Social Map-->
				<div class="col-md-9" style="width:75%;">
					<div style="height:450px;width: 100%;" id="social_map_container"></div>
				</div>
				<div class="col-md-3 legend-box">

				</div>
				
			</div>
			<div class="tab-pane fade" id="tab_1_1">
				<!--Summary Report-->
				<div class="table-scrollable">
				<table id="summary_table" class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th><span class="lang_en">Caption</span><span class="hide_lang lang_bd">সূচক</span></th>
							<th></th>
						</tr>
					</thead>
					<tbody>

					</tbody>
				</table>
				</div>
				<a href="" id="summary_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_2">
				<!--Seasonal Calendar-->
				<div class="table-scrollable">
					<table id="season_table" class="table table-striped table-bordered table-hover">
						<thead>
							<tr>
								<th><span class="lang_en">Subject</span><span class="hide_lang lang_bd">বিষয়</span></th>
								<th><span class="lang_en">Boishakh</span><span class="hide_lang lang_bd">বৈশাখ</span></th>
								<th><span class="lang_en">Joistha</span><span class="hide_lang lang_bd">জ্যৈষ্ঠ</span></th>
								<th><span class="lang_en">Asharh</span><span class="hide_lang lang_bd">আষাঢ়</span></th>
								<th><span class="lang_en">Shrabon</span><span class="hide_lang lang_bd">শ্রাবণ</span></th>
								<th><span class="lang_en">Vadro</span><span class="hide_lang lang_bd">ভাদ্র</span></th>
								<th><span class="lang_en">Ashshin</span><span class="hide_lang lang_bd">আশ্বিন</span></th>
								<th><span class="lang_en">Kartik</span><span class="hide_lang lang_bd">কার্তিক</span></th>
								<th><span class="lang_en">Ogrohayon</span><span class="hide_lang lang_bd">অগ্রহায়ণ</span></th>
								<th><span class="lang_en">Poush</span><span class="hide_lang lang_bd">পৌষ</span></th>
								<th><span class="lang_en">Magh</span><span class="hide_lang lang_bd">মাঘ</span></th>
								<th><span class="lang_en">Falgun</span><span class="hide_lang lang_bd">ফাল্গুন</span></th>
								<th><span class="lang_en">Chaitra</span><span class="hide_lang lang_bd">চৈত্র</span></th>
							</tr>
						</thead>
						<tbody>
							
						</tbody>
					</table>
				</div>
				<a href="" id="season_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_3">
				<!--Crop Calendar-->
				<div class="table-scrollable">
					<table id="crop_table" class="table table-striped table-bordered table-hover">
						<thead>
							<tr>
								<th colspan="2"><span class="lang_en">Crop</span><span class="hide_lang lang_bd">ফসল</span></th>
								<th colspan="2"><span class="lang_en">Boishakh</span><span class="hide_lang lang_bd">বৈশাখ</span></th>
								<th colspan="2"><span class="lang_en">Joistha</span><span class="hide_lang lang_bd">জ্যৈষ্ঠ</span></th>
								<th colspan="2"><span class="lang_en">Asharh</span><span class="hide_lang lang_bd">আষাঢ়</span></th>
								<th colspan="2"><span class="lang_en">Shrabon</span><span class="hide_lang lang_bd">শ্রাবণ</span></th>
								<th colspan="2"><span class="lang_en">Vadro</span><span class="hide_lang lang_bd">ভাদ্র</span></th>
								<th colspan="2"><span class="lang_en">Ashshin</span><span class="hide_lang lang_bd">আশ্বিন</span></th>
								<th colspan="2"><span class="lang_en">Kartik</span><span class="hide_lang lang_bd">কার্তিক</span></th>
								<th colspan="2"><span class="lang_en">Ogrohayon</span><span class="hide_lang lang_bd">অগ্রহায়ণ</span></th>
								<th colspan="2"><span class="lang_en">Poush</span><span class="hide_lang lang_bd">পৌষ</span></th>
								<th colspan="2"><span class="lang_en">Magh</span><span class="hide_lang lang_bd">মাঘ</span></th>
								<th colspan="2"><span class="lang_en">Falgun</span><span class="hide_lang lang_bd">ফাল্গুন</span></th>
								<th colspan="2"><span class="lang_en">Chaitra</span><span class="hide_lang lang_bd">চৈত্র</span></th>
								<th class="text-center"><span class="lang_en">Land (Bigha)</span><span class="hide_lang lang_bd">জমির পরিমাণ</span></th>
								<th class="text-center"><span class="lang_en">Production (Mon)</span><span class="hide_lang lang_bd">উতপাদনের পরিমাণ</span></th>
								<th class="text-center"><span class="lang_en">Farmer Count</span><span class="hide_lang lang_bd">কৃষকের সংখ্যা</span></th>
							</tr>
						</thead>
						<tbody>
							
						</tbody>
					</table>
				</div>
				<a href="" id="crop_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_4">
				<!--Impact of Climate Change-->
				<div class="table-scrollable">
				<table id="climate_table" class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th><span class="lang_en">Phenomenon</span><span class="hide_lang lang_bd">জলবায়ু পরিবর্তন</span></th>
							<th><span class="lang_en">Imapact</span><span class="hide_lang lang_bd">প্রভাব</span></th>
							<th colspan="2"><span class="lang_en">Boishakh</span><span class="hide_lang lang_bd">বৈশাখ</span></th>
							<th colspan="2"><span class="lang_en">Joistha</span><span class="hide_lang lang_bd">জ্যৈষ্ঠ</span></th>
							<th colspan="2"><span class="lang_en">Asharh</span><span class="hide_lang lang_bd">আষাঢ়</span></th>
							<th colspan="2"><span class="lang_en">Shrabon</span><span class="hide_lang lang_bd">শ্রাবণ</span></th>
							<th colspan="2"><span class="lang_en">Vadro</span><span class="hide_lang lang_bd">ভাদ্র</span></th>
							<th colspan="2"><span class="lang_en">Ashshin</span><span class="hide_lang lang_bd">আশ্বিন</span></th>
							<th colspan="2"><span class="lang_en">Kartik</span><span class="hide_lang lang_bd">কার্তিক</span></th>
							<th colspan="2"><span class="lang_en">Ogrohayon</span><span class="hide_lang lang_bd">অগ্রহায়ণ</span></th>
							<th colspan="2"><span class="lang_en">Poush</span><span class="hide_lang lang_bd">পৌষ</span></th>
							<th colspan="2"><span class="lang_en">Magh</span><span class="hide_lang lang_bd">মাঘ</span></th>
							<th colspan="2"><span class="lang_en">Falgun</span><span class="hide_lang lang_bd">ফাল্গুন</span></th>
							<th colspan="2"><span class="lang_en">Chaitra</span><span class="hide_lang lang_bd">চৈত্র</span></th>
						</tr>
					</thead>
					<tbody>

					</tbody>
				</table>
				</div>
				<a href="" id="climate_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_5">
				<!--Livelihood Analysis-->
				<table id="livelihood_table" class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th><span class="lang_en">Income Type</span><span class="hide_lang lang_bd">আয়ের ধরন</span></th>
							<th><span class="lang_en">Numer of Families Involved</span><span class="hide_lang lang_bd">বর্তমানে কত পরিবার এই পেশার সাথে জড়িত</span></th>
							<th><span class="lang_en">Numer of Families Involved in Last 10 Years</span><span class="hide_lang lang_bd">বিগত ১০ বছরে কত পরিবার এই পেশার সাথে জড়িত ছিলো</span></th>
							<th><span class="lang_en">Changes in Last 10 Years</span><span class="hide_lang lang_bd">বিগত ১০ বছরে কি ধরনের পরিবর্তন হয়েছে</span></th>
							<th width="30%"><span class="lang_en">Types of Monthy Income</span><span class="hide_lang lang_bd">মাসিক আয়ের ধরন</span></th>
							<th><span class="lang_en">Problems Faced</span><span class="hide_lang lang_bd">কি ধরনের সমস্যার সম্মুখ হন</span></th>
							<th><span class="lang_en">New Opportunities</span><span class="hide_lang lang_bd">নতুন কোন কাজ করার সু্যোগ আছে কি?</span></th>
						</tr>
					</thead>
					<tbody>

					</tbody>
				</table>
				<a href="" id="livelihood_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_6">
				<!--Problem Identification and Prioritizing Matrix-->
				<table id="priority_table" class="table table-hover table-bordered table-striped table-scrollable">
					<thead>
						<tr>
							<th width="20%"><span class="lang_en">Priority Index</span><span class="hide_lang lang_bd">অগ্রাধিকার নং</span></th>
							<th><span class="lang_en">Problem</span><span class="hide_lang lang_bd">সমস্যা অগ্রাধিকরণ</span></th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
				<a href="" id="priority_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_7">
				<!--Solution to Problems-->
				<table id="solution_matrix_table" class="table table-hover table-bordered table-striped table-scrollable">
					<thead>
						<tr>
							<th><span class="lang_en">Work Description</span><span class="hide_lang lang_bd">কাজের বিবরণ</span></th>
							<th><span class="lang_en">Problem (What/When)</span><span class="hide_lang lang_bd">কি সমস্যা/কখন</span></th>
							<th><span class="lang_en">Short Term Solution</span><span class="hide_lang lang_bd">তাৎক্ষনিক সমাধান</span></th>
							<th><span class="lang_en">Long Term Solution</span><span class="hide_lang lang_bd">দীর্ঘমেয়াদি সমাধান</span></th>
							<th><span class="lang_en">Necessary Resource Available?</span><span class="hide_lang lang_bd">প্রয়োজনীয় সম্পদ কি আছে?</span></th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
				<a href="" id="solution_table_edit_instance" class="btn red">Edit</a>
			</div>
			<div class="tab-pane fade" id="tab_1_8">
				<!--Action Plan-->
				<table id="action_plan_table" class="table table-hover table-bordered table-striped table-scrollable">
					<thead>
						<tr>
							<th><span class="lang_en">Work Description</span><span class="hide_lang lang_bd">কাজের বিবরণ</span></th>
							<th><span class="lang_en">Schedule</span><span class="hide_lang lang_bd">কখন করবে</span></th>
							<th><span class="lang_en">Assigned personals</span><span class="hide_lang lang_bd">কে করবে</span></th>
							<th><span class="lang_en">Work Process</span><span class="hide_lang lang_bd">কিভাবে করবে</span></th>
							<th><span class="lang_en">Work Volume</span><span class="hide_lang lang_bd">কাজের পরিমাণ</span></th>
							<th><span class="lang_en">Responsible Personals</span><span class="hide_lang lang_bd">দায়িত্বপ্রাপ্ত ব্যাক্তি</span></th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
				<a href="" id="action_table_edit_instance" class="btn red">Edit</a>
			</div>
		</div>
	</div>
</div>
{% endblock %}
{% block additional-javascript %}
<script src="{{ STATIC_URL }}js/csvp_scripts/singel_village.js"></script>
<script src="{{ STATIC_URL }}js/jquery.cookie.js"></script>
<script type="text/javascript">
	var lists = '<ul class="list-inline sidebar-tags">';
	var icons_array = [];
	var icons_trace_array = [];
	var icons_shape_array = [];
	$(document).ready(function() {
		$('.page-content').css('min-height','600px');
		for(var idx in legends_data) {
			var type = legends_data[idx][10].replace(". ", "_");
			if (legends_data[idx][8] == 'geopoint'){
				if($.inArray(type, icons_array) == -1){ 
					icons_array.push(type);
				}
			} else if (legends_data[idx][8] == 'geotrace'){
				if($.inArray(type, icons_trace_array) == -1){ 
					icons_trace_array.push(type);
				}
			} else {
				if($.inArray(type, icons_shape_array) == -1){ 
					icons_shape_array.push(type);
				}
			}
		}

		icons_array.forEach(function(elem) {
			lists += '<li><img src="/static/assets/img/CSVP_Legends/'+elem+'.png"/> '+elem.split('_')[1]+'</li></br>';
		});

		icons_trace_array.forEach(function(elem) {
			var shape_name = elem.split('_')[1];
			lists += '<li><div style="background:#FF0000;" class="line_color"></div> '+shape_name+'</li></br>';
		});

		icons_shape_array.forEach(function(elem) {
			var shape_name = elem.split('_')[1];
			if(elem != '1_Village borders'){
			var fill_color = findWithAttr(legendShapeProp, 'name', elem, 'fill_color');
			lists += '<li><div style="background:'+fill_color+';" class="rectangle_color"></div> '+shape_name+'</li></br>';
			} else {
				var border_color = findWithAttr(legendShapeProp, 'name', elem, 'border_color');
				lists += '<li><div style="background:'+border_color+';" class="line_color"></div> '+shape_name+'</li></br>';
			}
		});

		lists += '</ul>';


		$('.legend-box').html(lists);
		var set_lang = 'e';
		if($.cookie('lang')){
			set_lang = $.cookie('lang');//get language value from cookie
		}
		if (set_lang != ''){
			$('#lang-switch').val(set_lang);
			
			if(set_lang == 'b'){
				$('.lang_en').hide();
				$('.lang_bd').show();
			}
		}
		//$('body').css('overflow','hidden');	
	});

	var legends_data = {{ legends_data|safe }}
	var crop_data = {{ crop_data|safe }};
	var priority_data = {{ priority_data|safe }}
	var climate_imapct_data = {{ climate_imapct_data|safe }}
	var season_data = {{ season_data|safe }}
	var problem_matrix_data = {{ problem_matrix_data|safe }}
	var livelihood_data = {{ livelihood_data|safe }}
	var village_labels_data = {{ village_labels_data|safe }}
	var village_summary_data_test = {{ village_summary_data_test|safe }}
	var village_info_data = {{ village_info_data|safe }}
	var action_plan_data = {{ action_plan_data|safe }}

	villageSummaryData = generateVillageSummaryTable(village_summary_data_test);
	$('#summary_table').find('tbody').html(villageSummaryData);

	actionPlanData = generateActionPlanData(action_plan_data);
	$('#action_plan_table').find('tbody').html(actionPlanData);

	populateVillageLabels(village_labels_data);

	cropTableData = generateCropTableRows(crop_data);
	$("#crop_table").find('tbody').html(cropTableData);

	priorityTableData  = generateProblemRankTableRows(priority_data);
	$("#priority_table").find('tbody').html(priorityTableData);

	climateImpactData = generateImapctTableRows(climate_imapct_data);
	$("#climate_table").find('tbody').html(climateImpactData)

	seasonTableData = generateSeasonTableRows(season_data);
	$("#season_table").find('tbody').html(seasonTableData);

	problemMatrixTableData = generateProblemMatrixTableRows(problem_matrix_data);
	$('#solution_matrix_table').find('tbody').html(problemMatrixTableData);

	livelihoodData = generateLivlihoodTableData(livelihood_data);
	$('#livelihood_table').find('tbody').html(livelihoodData);

	$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		var target = $(e.target).attr("href")
    });

</script>
<script src="{{ STATIC_URL }}js/csvp_scripts/csvp_map_conf.js"></script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkpHOGjk9Z32PtCtZ85tPfn3MUVuMBRxE&libraries=geometry&callback=initMap"></script>
{% endblock %}
